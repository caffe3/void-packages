From 4704b1cc4ca80c5cb7672fdf43108a1d23e9662d Mon Sep 17 00:00:00 2001
From: Daniel Larraz <daniel-larraz@users.noreply.github.com>
Date: Fri, 10 Jan 2025 13:01:01 -0600
Subject: [PATCH 291/312] ci: Provide project description for the PyPI packages
 (#11506)
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

The `readme` field sets the projectâ€™s description on PyPI.
---
 .github/workflows/package_pypi.yml | 6 +++++-
 src/api/python/pyproject.toml      | 1 +
 2 files changed, 6 insertions(+), 1 deletion(-)

diff --git a/.github/workflows/package_pypi.yml b/.github/workflows/package_pypi.yml
index 6da5ac691..8d142f4be 100644
--- a/.github/workflows/package_pypi.yml
+++ b/.github/workflows/package_pypi.yml
@@ -88,10 +88,14 @@ jobs:
         mkdir -p build/src/api/python
         if [ "${{ matrix.gpl }}" == "true" ]; then
           sed -e 's/^name="cvc5"$/name="cvc5-gpl"/' \
+              -e 's/^\(description=".*\)"/\1 (GPL version)"/' \
+              -e 's/^\(readme = {text = ".*\)\(", content-type = "text\/plain"\)/\1 (GPL version)\2/' \
               -e 's/^license = {text = "/license = {text = "GPL-2.0-or-later AND GPL-3.0-or-later AND /' \
               ./src/api/python/pyproject.toml > ./build/src/api/python/pyproject.toml
         else
-          cp src/api/python/pyproject.toml build/src/api/python/
+          sed -e 's/^\(description=".*\)"/\1 (BSD version)"/' \
+              -e 's/^\(readme = {text = ".*\)\(", content-type = "text\/plain"\)/\1 (BSD version)\2/' \
+              ./src/api/python/pyproject.toml > ./build/src/api/python/pyproject.toml
         fi
         echo "::endgroup::"
 
diff --git a/src/api/python/pyproject.toml b/src/api/python/pyproject.toml
index c09c8f1ec..18ec8f391 100644
--- a/src/api/python/pyproject.toml
+++ b/src/api/python/pyproject.toml
@@ -12,6 +12,7 @@ build-backend = "setuptools.build_meta"
 [project]
 name="cvc5"
 description="Python bindings for cvc5"
+readme = {text = "Python bindings for cvc5", content-type = "text/plain"}
 dynamic = ["version"]
 license = {text = "BSD-3-Clause AND LGPL-3.0-or-later AND MIT"}
 # BSD-3-Clause      : cvc5 library and Python API
-- 
2.47.1

