# Template file for libcurand126-devel
_cudaver=12.6
_pkgname=libcurand-dev-${_cudaver/./-}
_version=10.3.7.77-1
_arch=amd64
pkgname=libcurand-devel
version=10.3.7.77
revision=1
archs="x86_64*"
build_style=fetch
hostmakedepends="dpkg binutils xz"
depends="cuda-toolkit-config-common libcurand>=10.3.7.77"
short_desc="CURAND native dev links,headers"
maintainer="Tai Chi Minh Ralph Eastwood <caffe@disroot.org>"
license="custom:NVIDIA Proprietary"
homepage="https://developer.nvidia.com/cuda-toolkit"
distfiles="https://developer.download.nvidia.com/compute/cuda/repos/ubuntu2404/x86_64/./${_pkgname}_${_version}_${_arch}.deb"
checksum=5f624b81c90cd030a4e91bf06c6c77e9f0c07af2a7310eabf1fe9b8757806e42
repository=nonfree
nopie=yes
nostrip=yes

case "$XBPS_TARGET_MACHINE" in
	# the downloaded toolchains use glibc, this allows them to work on musl
	*-musl) depends+=" gcompat" ;;
esac

do_extract() {
  ar x ${XBPS_SRCDISTDIR}/${pkgname}-${version}/${_pkgname}_${_version}_${_arch}.deb
}

do_install() {
  bsdtar -C ${DESTDIR} -s '#/usr/local#/opt#' -xf data.tar.*
  rm -f ${DESTDIR}/opt/cuda-${_cudaver}/include
  rm -f ${DESTDIR}/opt/cuda-${_cudaver}/lib64
  vlicense ${DESTDIR}/usr/share/doc/${_pkgname}/copyright LICENSE
  rm ${DESTDIR}/usr/share/doc/${_pkgname}/copyright
  rm -f ${DESTDIR}/usr/share/doc/${_pkgname}/changelog.Debian.gz
}
